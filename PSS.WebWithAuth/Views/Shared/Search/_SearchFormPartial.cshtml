@model PSS.WebWithAuth.ViewModels.SearchFilterViewModel
@using PSS.WebWithAuth.Infrastructure;
@Html.Resource(@<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>, "js")
@Html.Resource(@<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>, "js")
@Html.Resource(@<script type="text/javascript">
                    // routine to convert url parameters to seo friendly format
                    $(document).ready(function () {
                        $('#linksearch').click(function (e) {
                            e.preventDefault();
                            $('#submitsearch').click();
                        });
                        $('#submitsearch').click(function (e) {
                            e.preventDefault();
                            var $theform = $('#seoform');
                            var $oform = $('#oform');
                            // workaround for IE9 placeholders bug
                            var $zip = $('#ZipFilter');
                            $zip.val($zip.val() == 'Zip code' ? '' : $zip.val());
                            if ($oform.valid()) {
                                $.post('@Url.Action("GetSeoParameters", "Search")', $oform.serialize(), function (json) {
                                    // handle response
                                    // put values in seo form
                                    var cityval = $('#CityFilter').val();
                                    $('#city').val(cityval == 'City' ? '' : cityval); // ugly workaround for IE9 placeholders bug
                                    var stateval = $('#StateFilter').val();
                                    $('#state').val(stateval == 'State' ? '' : stateval);
                                    var zipval = $('#ZipFilter').val();
                                    $('#zip').val(zipval == 'Zip code' ? '' : zipval);
                                    $('#typesofcare').val(json.typesofcare);
                                    //$.validator.unobtrusive.parse($theform);$theform.validate();
                                    //alert($('#typesofcare').val());
                                    $theform.submit();
                                }, "json");
                            }
                        });
                    });
</script>, "js")
<div class="formArea clearfix">
    <h2>Begin Your Search Today!</h2>
@using (Html.BeginForm("GetSeoParameters", "Search", FormMethod.Get, new { @class = "searchForm", id = "oform" }))
{
    @Html.ValidationSummary(true)
    <fieldset class="row left small">
		<label class="smallCol">
            @Html.EditorFor(model => model.CityFilter)
            @Html.ValidationMessageFor(model => model.CityFilter)
        </label>
        <label class="smallCol">
            @Html.EditorFor(model => model.StateFilter)
            @Html.ValidationMessageFor(model => model.StateFilter)
        </label>
        <div class="smallCol">
            <label class="smallCol">
                @Html.EditorFor(model => model.ZipFilter)
                @Html.ValidationMessageFor(model => model.ZipFilter)
            </label>
        </div>
    </fieldset>
    <fieldset class="row right small">
        @Html.EditorFor(model => model.TypeOfCareFilter)
	</fieldset>
    <fieldset class="row right small">
        <div class="smallCol">
		    <button id="linksearch" type="submit" class="btnPattern submit">Search</button>
	    </div>
    </fieldset>
}
<!--/searchForm-->
</div>
@using (Html.BeginForm("SearchResults", "Search", FormMethod.Get, new { @class = "", id = "seoform", style = "display: none" }))
{
    @Html.ValidationSummary(true)
    @Html.Hidden("searchtype", "undefined", new { id = "searchtype" })
    @Html.Hidden("city", Model.CityFilter, new { id = "city" })
    @Html.Hidden("state", Model.StateFilter, new { id = "state" })
    @Html.Hidden("zip", Model.ZipFilter, new { id = "zip" })
    @Html.Hidden("typesofcare", Model.TypesOfCareSeoParameterFormatted, new { id = "typesofcare" })
    @Html.Hidden("latitude", 0, new { id = "latitude" })
    @Html.Hidden("longitude", 0, new { id = "longitude" })
    <input id="submitsearch" type="submit" value="Search" style="display: none" />
}